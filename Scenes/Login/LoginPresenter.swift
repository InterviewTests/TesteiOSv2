//
//  LoginPresenter.swift
//  TesteiOSv2
//
//  Created by Marcel Mendes Filho on 26/02/19.
//  Copyright (c) 2019 Accenture do Brasil Ltda. All rights reserved.
//
//  This file was generated by the Clean Swift Xcode Templates so
//  you can apply clean architecture to your iOS and Mac projects,
//  see http://clean-swift.com
//

import UIKit

protocol LoginPresentationLogic
{
    func processResult(response: Login.CredentialsValidation.Response)
    func prefillUsername(response: Login.LastUserLogin.Response)
}

class LoginPresenter: LoginPresentationLogic
{
  weak var viewController: LoginDisplayLogic?
  
  // MARK: Do something
    
    func prefillUsername(response: Login.LastUserLogin.Response) {
        if let username = response.username{
            viewController?.setUsernameTextField(viewModel: Login.LastUserLogin.ViewModel(username: username))
        }
    }
  
    func processResult(response: Login.CredentialsValidation.Response){
        
        var viewModel = Login.CredentialsValidation.ViewModel()

        if !response.isUsernameValid{
            viewModel.userMessage = Constants.Login.usernameDoesntMatchRequirements
            viewController?.displayInvalidUserErrorMessage(viewModel: viewModel)
        } else if !response.isPasswordValid{
            viewModel.userMessage = Constants.Login.passwordDoesntMatchRequirements
            viewController?.displayInvalidPasswordErrorMessage(viewModel: viewModel)
        } else if !response.areCredentialsValid{
            viewModel.userMessage = Constants.Login.credentialsNotValid
            viewController?.displayInvalidCredentials(viewModel: viewModel)
        } else {
            viewController?.finishedCredentialsValidation(response: response)
        }
    }
    
}
