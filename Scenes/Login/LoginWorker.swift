//
//  LoginWorker.swift
//  TesteiOSv2
//
//  Created by Marcel Mendes Filho on 26/02/19.
//  Copyright (c) 2019 Accenture do Brasil Ltda. All rights reserved.
//
//  This file was generated by the Clean Swift Xcode Templates so
//  you can apply clean architecture to your iOS and Mac projects,
//  see http://clean-swift.com
//

import UIKit

class LoginWorker
{
    func isUsernameValid(username: String) -> Bool{
        return Common.validations.isValidEmail(email: username) || Common.validations.isValidCPF(cpf: username)
    }
    
    func isPasswordValid(password: String) -> Bool{
        return Common.validations.isValidPassword(password: password)
    }
    
    func validateCredentials(username: String, password: String, completionResult: @escaping (UserAccountModel?, Bool) -> Void){
        
        let parameters = ["user": username, "password": password]

        NetworkRequest.shared.send(endPoint: Constants.Request.login, httpMethod: Constants.httpMethod.POST, additionalHeaders: nil, parameters: parameters, completionSuccess: { (data) in
            if let userAccount = UserAccountModel(data: data){
                print("User Account: ", userAccount)
                completionResult(userAccount, true)
                return
            } else {
                completionResult(nil, false)
            }
        }, completionError: { (serverErrorCode) in
            print(serverErrorCode)
            completionResult(nil, false)
        }) { (error) in
            print(error)
            completionResult(nil, false)
        }
    }

    
    
}
